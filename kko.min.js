!function(t){"use strict";var n=[];"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(t,e){var o;return n.push(t),"function"==typeof window.createEvent?(o=document.createEvent("CustomEvent"),o.initCustomEvent(t,!(!e||!e.bubbles),!(!e||!e.cancelable),e?e.details:null),o):void(document.documentElement["eventProperty"+t]=!1)});var e=function(t,e){var o={},a={},i="storylink://posting?",r="1.0",u={android:"market://details?id=com.kakao.story",ios:"http://itunes.apple.com/app/id486244601"},s="com.kakao.story",l=!1,c="function"==typeof document.addEventListener?!0:!1,d=function(t,n){"function"==typeof document.dispatchEvent?document.dispatchEvent(t):document.documentElement["eventProperty"+n]=!0},f=function(t,e,o){if(c===!0)t.addEventListener(e,o);else{if("load"===e)e="onreadystatechange";else{if(-1!==n.indexOf(e))return document.documentElement.attachEvent("onpropertychange",function(){var t=document.documentElement["eventProperty"+e];t===!0&&o.call(null)});e="on"+e}t.attachEvent(e,o)}},p=new CustomEvent("init"),m=new CustomEvent("login");f(document,"init",function(){l=!0});var k=function(t){var n=[];for(var e in t)t.hasOwnProperty(e)&&n.push(e+"="+encodeURIComponent(t[e]));return n.join("&")},y=function(t){Kakao.init(t),d(p,"init")};return o.init=function(t){if(window.Kakao)y(t);else{var n=document.getElementsByTagName("body")[0],e=document.createElement("script");e.src="https://developers.kakao.com/sdk/js/kakao.min.js",f(e,"load",function(){c===!0?y(t):("loaded"===e.readyState||"complete"===e.readyState)&&y(t)}),void 0===n?f(document,"load",function(){n=document.getElementsByTagName("body")[0],n.insertBefore(e,n.lastChild)}):n.insertBefore(e,n.lastChild)}},o.on=function(t,n){f(document,t,n)},o.login=function(t,n){Kakao.Auth.login({success:function(){Kakao.Auth.getStatus(function(n){a=n,Kakao.API.request({url:"/v1/api/story/isstoryuser"}).then(function(t){return a.isStoryUser=t.isStoryUser,a.isStoryUser?Kakao.API.request({url:"/v1/api/story/profile"}):void 0}).then(function(e){a.kakaoStoryProfile=e,a.status="connected",d(m,"login"),t&&t.call(null,n)})})},fail:function(t){n&&n.call(null,t)}})},o.logout=function(t){Kakao.Auth.logout(function(n){a.status=!1,t&&t.call(null,n)})},o.getInfo={status:function(){return"connected"===a.status?!0:!1},me:function(){if("connected"===a.status&&a.user){var t={};return t.id=a.user.id,t.iskakaoStoryUser=a.isStoryUser,t.kakaoStoryUser&&void 0!==a.kakaoStoryProfile&&(t.kakaoStoryProfile=a.kakaoStoryProfile),Object.keys(a.user.properties).map(function(n){t[n]=a.user.properties[n]}),t}return!1}},o.talk={sendLink:function(t){void 0!==t.image&&(t.image.width=t.image.width||"300",t.image.height=t.image.height||"400"),Kakao.Link.sendTalkLink(t)}},o.story={sendLink:function(t,n,e,o){Kakao.Auth.login({success:function(){Kakao.API.request({url:"/v1/api/story/linkinfo",data:{url:t}}).then(function(t){var e={};return e.link_info=t,void 0!==n&&(e.content=n),Kakao.API.request({url:"/v1/api/story/post/link",data:e})}).then(function(t){return Kakao.API.request({url:"/v1/api/story/mystory",data:{id:t.id}})}).then(function(t){e&&e.call(null,t)})},fail:function(t){o&&o.call(null,t)}})},openSharer:function(t,n,e){var o="https://story.kakao.com/share?url=%url";t=encodeURIComponent(t),n=n||400,e=e||480,o=o.replace(/%url/,t),window.open(o,"","width="+n+",height="+e)},openApp:function(n,o,a,l){var c={};c.appId=n,c.apiver=r,c.post=l&&urlFist===!0?o+" "+a:a+" "+o;var d=i+k(c),f="intent:"+d+"#Intent;package="+s+";end;",p=t().os.android?u.android:u.ios;e({urlScheme:d,intentURI:f,storeURL:p,appName:"KakaoStory"})},getStory:function(t,n,e){var o,a,i,r={};if("function"==typeof t)a=t,i=n,r.url="/v1/api/story/mystories";else{if("string"!=typeof t)return{error:"invaild parameters"};o=t,a=n,i=e,r.url="/v1/api/story/mystory",r.data={id:o}}Kakao.Auth.login({success:function(){Kakao.API.request(r).then(function(t){a.call(null,t)})},fail:function(t){i.call(null,t)}})},getStoriesBefore:function(t,n,e){Kakao.Auth.login({success:function(){Kakao.API.request({url:"/v1/api/story/mystories",data:{last_id:t}}).then(function(t){n.call(null,t)})},fail:function(t){e.call(null,t)}})}},o}(i,r),o=function(t){throw t=t.join(", "),"dependency error: module not found("+t+")"},a=[];if(void 0!==typeof t.daumtools){var i=void 0!==t.daumtools.userAgent?t.daumtools.userAgent:null,r=void 0!==t.daumtools.web2app?t.daumtools.web2app:null;null===i&&a.push("userAgent"),null===r&&a.push("web2app"),a.length>0&&o(a)}else a.push("userAgent"),a.push("web2app"),o(a);"function"==typeof define&&define.amd?define(["kko","userAgent","web2app","exports"],function(t,n,e,o){o.kko=t}):t.kko=e}(window);